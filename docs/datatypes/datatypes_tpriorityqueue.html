<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>TPriorityQueue · ZIO</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="A `TPriorityQueue[A]` is a mutable queue that can participate in STM transactions. A `TPriorityQueue` contains values of type `A` for which an `Ordering` is defined. Unlike a `TQueue`, `take` returns the highest priority value (the value that is first in the specified ordering) as opposed to the first value offered to the queue. The ordering of elements sharing the same priority when taken from the queue is not guaranteed."/><meta name="docsearch:language" content="en"/><meta property="og:title" content="TPriorityQueue · ZIO"/><meta property="og:type" content="website"/><meta property="og:url" content="https://zio.dev/"/><meta property="og:description" content="A `TPriorityQueue[A]` is a mutable queue that can participate in STM transactions. A `TPriorityQueue` contains values of type `A` for which an `Ordering` is defined. Unlike a `TQueue`, `take` returns the highest priority value (the value that is first in the specified ordering) as opposed to the first value offered to the queue. The ordering of elements sharing the same priority when taken from the queue is not guaranteed."/><meta name="twitter:card" content="summary"/><link rel="shortcut icon" href="/img/favicon.png"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script src="https://unpkg.com/vanilla-back-to-top@7.1.14/dist/vanilla-back-to-top.min.js"></script><script>
        document.addEventListener('DOMContentLoaded', function() {
          addBackToTop(
            {"zIndex":100,"cornerOffset":100}
          )
        });
        </script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/navbar_brand.png" alt="ZIO"/><h2 class="headerTitleWithLogo">ZIO</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/docs/overview/overview_index" target="_self">Overview</a></li><li class=""><a href="/docs/datatypes/datatypes_index" target="_self">Data Types</a></li><li class=""><a href="/docs/interop/interop_index" target="_self">Interop</a></li><li class=""><a href="/docs/usecases/usecases_index" target="_self">Use Cases</a></li><li class=""><a href="/docs/howto/howto_index" target="_self">How to</a></li><li class=""><a href="/docs/resources/resources" target="_self">Resources</a></li><li class=""><a href="/docs/ecosystem/ecosystem" target="_self">Ecosystem</a></li><li class=""><a href="/docs/about/about_index" target="_self">About</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 id="__docusaurus" class="postHeaderTitle">TPriorityQueue</h1></header><article><div><span><p>A <code>TPriorityQueue[A]</code> is a mutable queue that can participate in STM transactions. A <code>TPriorityQueue</code> contains values of type <code>A</code> for which an <code>Ordering</code> is defined. Unlike a <code>TQueue</code>, <code>take</code> returns the highest priority value (the value that is first in the specified ordering) as opposed to the first value offered to the queue. The ordering of elements sharing the same priority when taken from the queue is not guaranteed.</p>
<h2><a class="anchor" aria-hidden="true" id="creating-a-tpriorityqueue"></a><a href="#creating-a-tpriorityqueue" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Creating a TPriorityQueue</h2>
<p>You can create an empty <code>TPriorityQueue</code> using the <code>empty</code> constructor:</p>
<pre><code class="hljs css language-scala"><span class="hljs-keyword">import</span> zio._
<span class="hljs-keyword">import</span> zio.stm._

<span class="hljs-keyword">val</span> minQueue: <span class="hljs-type">STM</span>[<span class="hljs-type">Nothing</span>, <span class="hljs-type">TPriorityQueue</span>[<span class="hljs-type">Int</span>]] =
  <span class="hljs-type">TPriorityQueue</span>.empty
</code></pre>
<p>Notice that a <code>TPriorityQueue</code> is created with an implicit <code>Ordering</code>. By default, <code>take</code> will return the value that is first in the specified ordering. For example, in a queue of events ordered by time the earliest event would be taken first. If you want a different behavior you can use a custom <code>Ordering</code>.</p>
<pre><code class="hljs css language-scala"><span class="hljs-keyword">val</span> maxQueue: <span class="hljs-type">STM</span>[<span class="hljs-type">Nothing</span>, <span class="hljs-type">TPriorityQueue</span>[<span class="hljs-type">Int</span>]] =
  <span class="hljs-type">TPriorityQueue</span>.empty(<span class="hljs-type">Ordering</span>[<span class="hljs-type">Int</span>].reverse)
</code></pre>
<p>You can also create a <code>TPriorityQueue</code> initialized with specified elements using the <code>fromIterable</code> or <code>make</code> constructors&quot;. The <code>fromIterable</code> constructor takes a <code>Iterable</code> while the <code>make</code> constructor takes a variable arguments sequence of elements.</p>
<h2><a class="anchor" aria-hidden="true" id="offering-elements-to-a-tpriorityqueue"></a><a href="#offering-elements-to-a-tpriorityqueue" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Offering elements to a TPriorityQueue</h2>
<p>You can offer elements to a <code>TPriorityQueue</code> using the <code>offer</code> or <code>offerAll</code> methods. The <code>offerAll</code> method is more efficient if you want to offer more than one element to the queue at the same time.</p>
<pre><code class="hljs css language-scala"><span class="hljs-keyword">val</span> queue: <span class="hljs-type">STM</span>[<span class="hljs-type">Nothing</span>, <span class="hljs-type">TPriorityQueue</span>[<span class="hljs-type">Int</span>]] =
  <span class="hljs-keyword">for</span> {
    queue &lt;- <span class="hljs-type">TPriorityQueue</span>.empty[<span class="hljs-type">Int</span>]
    _     &lt;- queue.offerAll(<span class="hljs-type">List</span>(<span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">6</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>))
  } <span class="hljs-keyword">yield</span> queue
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="taking-elements-from-a-tpriorityqueue"></a><a href="#taking-elements-from-a-tpriorityqueue" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Taking elements from a TPriorityQueue</h2>
<p>Take an element from a <code>TPriorityQueue</code> using the <code>take</code>. <code>take</code> will semantically block until there is at least one value in the queue to take. You can also use <code>takeAll</code> to immediately take all values that are currently in the queue, or <code>takeUpTo</code> to immediately take up to the specified number of elements from the queue.</p>
<pre><code class="hljs css language-scala"><span class="hljs-keyword">val</span> sorted: <span class="hljs-type">STM</span>[<span class="hljs-type">Nothing</span>, <span class="hljs-type">Chunk</span>[<span class="hljs-type">Int</span>]] =
  <span class="hljs-keyword">for</span> {
    queue  &lt;- <span class="hljs-type">TPriorityQueue</span>.empty[<span class="hljs-type">Int</span>]
    _      &lt;- queue.offerAll(<span class="hljs-type">List</span>(<span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">6</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>))
    sorted &lt;- queue.takeAll
  } <span class="hljs-keyword">yield</span> sorted
</code></pre>
<p>You can also use <code>takeOption</code> method to take the first value from the queue if it exists without suspending or the <code>peek</code> method to observe the first element of the queue if it exists without removing it from the queue.</p>
<p>Sometimes you want to take a snapshot of the current state of the queue without modifying it. For this the <code>toChunk</code> combinator or its variants <code>toList</code> or <code>toVector</code> are extremely helpful. These will return an immutable collection that consists of all of the elements currently in the queue, leaving the state of the queue unchanged.</p>
<h2><a class="anchor" aria-hidden="true" id="size-of-a-tpriorityqueue"></a><a href="#size-of-a-tpriorityqueue" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Size of a TPriorityQueue</h2>
<p>You can check the size of the <code>TPriorityQueue</code> using the <code>size</code> method:</p>
<pre><code class="hljs css language-scala">
<span class="hljs-keyword">val</span> size: <span class="hljs-type">STM</span>[<span class="hljs-type">Nothing</span>, <span class="hljs-type">Int</span>] =
  <span class="hljs-keyword">for</span> {
    queue &lt;- <span class="hljs-type">TPriorityQueue</span>.empty[<span class="hljs-type">Int</span>]
    _     &lt;- queue.offerAll(<span class="hljs-type">List</span>(<span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">6</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>))
    size  &lt;- queue.size
  } <span class="hljs-keyword">yield</span> size
</code></pre>
</span></div></article></div><div class="docs-prevnext"></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#creating-a-tpriorityqueue">Creating a TPriorityQueue</a></li><li><a href="#offering-elements-to-a-tpriorityqueue">Offering elements to a TPriorityQueue</a></li><li><a href="#taking-elements-from-a-tpriorityqueue">Taking elements from a TPriorityQueue</a></li><li><a href="#size-of-a-tpriorityqueue">Size of a TPriorityQueue</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"><img src="/img/navbar_brand.png" alt="ZIO"/></a><div><h5>GitHub</h5><a href="https://github.com/zio/zio"><img src="https://img.shields.io/github/stars/zio/zio?style=social" alt="github"/></a></div><div><h5>Chat with us on Discord</h5><a href="https://discord.gg/2ccFBr4"><img src="https://img.shields.io/discord/629491597070827530?logo=discord&amp;style=social" alt="discord"/></a></div><div><h5>Follow us on Twitter</h5><a href="https://twitter.com/zioscala"><img src="https://img.shields.io/twitter/follow/zioscala?label=Follow&amp;style=social" alt="twitter"/></a></div><div><h5>Additional resources</h5><a href="https://javadoc.io/doc/dev.zio/zio_2.12/">Scaladoc of zio</a></div><div><a href="https://www.netlify.com"><img src="https://www.netlify.com/img/global/badges/netlify-color-accent.svg" alt="Deploys by Netlify"/></a></div></section><section class="copyright">Copyright © 2020 ZIO Maintainers</section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: '0c94b59071da7001757d08ab43d9e033',
                indexName: 'zio',
                inputSelector: '#search_input_react',
                algoliaOptions: {}
              });
            </script></body></html>